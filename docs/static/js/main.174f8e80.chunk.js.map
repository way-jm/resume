{"version":3,"sources":["../ /^/styles.*/.css$","components/style-text/styles0.css","components/style-text/styles1.css","components/style-text/styles2.css","components/work-text/work.txt","utils/util.ts","components/style-text/style-text.tsx","components/work-text/work-style.tsx","App.tsx","index.tsx"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","openComment","commentRegex","keyRegex","valueRegex","selectorRegex","pxRegex","pxRegex2","handleChar","fullText","char","slice","replace","test","endOfSentence","comma","endOfBlock","StyleText","props","useReducer","state","text","setText","innerRef","styleBuffer","elRef","useRef","styleText","i","require","writeTo","el","message","index","interval","charsPerInterval","a","animationSkipped","chars","scrollTop","scrollHeight","writeChar","length","thisInterval","thisSlice","Promise","delay","paused","styleAppend","useImperativeHandle","write","current","writeToEnd","txt","join","styleHTML","styleOverwrite","contentEditable","dangerouslySetInnerHTML","__html","ref","toHTML","Markdown","markdown","WorkStyle","workRef","el2Ref","writeSimpleChar","workText","mdText","useState","flipped","setFlipped","show","setShow","preview","setPreview","showWorkBox","setTimeout","flipping","wheel","dx","dy","half","clientHeight","className","App","styleRef","styleTagEl","document","getElementById","startAnimation","surprisinglyShortAttentionSpan","useEffect","then","textContent","ReactDOM","render"],"mappings":"wKAAA,IAAIA,EAAM,CACT,gBAAiB,GACjB,gBAAiB,GACjB,gBAAiB,IAIlB,SAASC,EAAeC,GACvB,IAAIC,EAAKC,EAAsBF,GAC/B,OAAOG,EAAoBF,GAE5B,SAASC,EAAsBF,GAC9B,IAAIG,EAAoBC,EAAEN,EAAKE,GAAM,CACpC,IAAIK,EAAI,IAAIC,MAAM,uBAAyBN,EAAM,KAEjD,MADAK,EAAEE,KAAO,mBACHF,EAEP,OAAOP,EAAIE,GAEZD,EAAeS,KAAO,WACrB,OAAOC,OAAOD,KAAKV,IAEpBC,EAAeW,QAAUR,EACzBS,EAAOC,QAAUb,EACjBA,EAAeE,GAAK,I,cCxBpBU,EAAOC,QAAU,+lG,cCAjBD,EAAOC,QAAU,ypB,cCAjBD,EAAOC,QAAU,qoC,oBCAjBD,EAAOC,QAAU,ktF,sICAbC,GAAc,EACZC,EAAe,4BACfC,EAAW,oBACXC,EAAa,WACbC,EAAgB,QAChBC,EAAU,MACVC,EAAW,KAGXC,EAAa,SAACC,EAAkBC,GAoBlC,OAnBIT,GAAwB,MAATS,EACfD,GAAYC,EACI,MAATA,GAAiBT,EAGR,MAATS,GAAuC,MAAvBD,EAASE,OAAO,IAAcV,GACrDA,GAAc,EACdQ,EAAWA,EAASG,QAAQV,EAAc,qCAC1B,MAATQ,EACPD,EAAWA,EAASG,QAAQT,EAAU,gCACtB,KAATO,EACPD,EAAWA,EAASG,QAAQR,EAAY,iCACxB,MAATM,EACPD,EAAWA,EAASG,QAAQP,EAAe,qCAC3B,MAATK,GAAgBJ,EAAQO,KAAKJ,EAASE,OAAO,IACpDF,EAAWA,EAASG,QAAQL,EAAU,oCAEtCE,GAAYC,GAdZT,GAAc,EACdQ,GAAYC,GAeTD,GChBLK,EAAgB,+BAChBC,EAAQ,0BACRC,EAAa,YAyEJC,EAvE6B,SAACC,GAAU,MAI3BC,sBAHxB,SAAcC,EAAUV,GACpB,OAAOF,EAAWY,EAAMV,KAEa,IAJU,mBAI5CW,EAJ4C,KAItCC,EAJsC,KAK5CC,EAAYL,EAAZK,SAEHC,EAAY,GAEVC,EAAQC,iBAAO,MACfC,EAAY,CAAC,EAAG,EAAG,GAAGzC,KAAI,SAAA0C,GAG5B,OAAOC,MAAQ,WAA0BD,EAAI,WAE3CE,EAAY,uCAAG,WAAOC,EAAaC,EAAiBC,EAAeC,EAAkBC,GAAtE,mBAAAC,EAAA,0DACblB,EAAMmB,iBADO,sBAEP,IAAI3C,MAAM,WAFH,UAIb4C,EAAQN,EAAQrB,MAAMsB,EAAOA,EAAQE,GACzCF,GAASE,EAETJ,EAAGQ,UAAYR,EAAGS,aAElBC,EAAUH,KAENL,EAAQD,EAAQU,QAXH,iBAYTC,EAAeT,EACfU,EAAYZ,EAAQrB,MAAMsB,EAAQ,EAAGA,GACrClB,EAAMF,KAAK+B,KACXD,EAA0B,GAAXT,GAEfpB,EAAcD,KAAK+B,KACnBD,EAA0B,GAAXT,GAEnBU,EAAYZ,EAAQrB,MAAMsB,EAAQ,EAAGA,EAAQ,GACzCjB,EAAWH,KAAK+B,KAChBD,EAA0B,GAAXT,GAtBN,yBA0BHW,IAAQC,MAAMH,GA1BX,WA2BJzB,EAAM6B,OA3BF,kDA4BNjB,EAAQC,EAAIC,EAASC,EAAOC,EAAUC,IA5BhC,4CAAH,8DA+BZM,EAAY,SAAC/B,GACfY,EAAQZ,GACRc,GAA0Bd,EACb,MAATA,GAAqB,MAAPA,IACdQ,EAAM8B,YAAYxB,GAClBA,EAAY,KAiBpB,OAdAyB,8BAAoB1B,GAAU,iBAAO,CACjC2B,MAAM,WAAD,4BAAE,WAAOjB,GAAP,SAAAG,EAAA,sEACGN,EAAQL,EAAM0B,QAASxB,EAAUM,GAAQ,EDlE7C,GCkEuD,GADtD,2CAAF,mDAAC,GAGNmB,WAAY,WAGR,IAFA,IAAIC,EAAM1B,EAAU2B,KAAK,MACrBC,EAAY,GACP3B,EAAI,EAAGA,EAAIyB,EAAIX,OAAQd,IAC5B2B,EAAY/C,EAAW+C,EAAWF,EAAIzB,IAE1CN,EAAQiC,GACRrC,EAAMsC,eAAe,oCAAsCH,QAG5D,yBAAKhE,GAAG,aAAaoE,iBAAe,EAACC,wBAAyB,CAACC,OAAQtC,GAAOuC,IAAKnC,K,wBC5ExFoC,E,OAASC,EAASC,SAASF,OAO3B/C,EAAgB,+BAChBC,EAAQ,0BACRC,EAAa,YAqGJgD,EApG6B,SAAC9C,GAAW,IAC7C+C,EAAW/C,EAAX+C,QAOP,IAAMC,EAAsCxC,iBAAoB,MAE1DI,EAAY,uCAAG,WAAOC,EAAaC,EAAiBC,EAAeC,EAAkBC,GAAtE,mBAAAC,EAAA,yDACbE,EAAQN,EAAQrB,MAAMsB,EAAOA,EAAQE,GACzCF,GAASE,EAETJ,EAAGQ,UAAYR,EAAGS,aAClB2B,EAAgB7B,KAEZL,EAAQD,EAAQU,QAPH,iBAQTC,EAAeT,EACfU,EAAYZ,EAAQrB,MAAMsB,EAAQ,EAAGA,GACrClB,EAAMF,KAAK+B,KACXD,EAA0B,GAAXT,GAEfpB,EAAcD,KAAK+B,KACnBD,EAA0B,GAAXT,GAEnBU,EAAYZ,EAAQrB,MAAMsB,EAAQ,EAAGA,EAAQ,GACzCjB,EAAWH,KAAK+B,KAChBD,EAA0B,GAAXT,GAlBN,yBAsBHW,IAAQC,MAAMH,GAtBX,WAuBJzB,EAAM6B,OAvBF,kDAwBNjB,EAAQC,EAAIC,EAASC,EAAOC,EAAUC,IAxBhC,4CAAH,8DA2BZgC,EAAkB,SAACzD,GACrBY,EAAQZ,IAtCuC,EAyC3BS,sBArCxB,SAAcC,EAAYV,GACtB,OAAOF,EAAWY,EAAOV,KAoCY,IAzCU,mBAyC5CW,EAzC4C,KAyCtCC,EAzCsC,KA2C7C8C,EAAWvC,EAAQ,IACnBwC,EAASR,EAAOO,GA5C6B,EA8CrBE,oBAAS,GA9CY,mBA8C5CC,EA9C4C,KA8CnCC,EA9CmC,OA+C3BF,oBAAS,GA/CkB,mBA+C5CG,EA/C4C,KA+CtCC,EA/CsC,OAgDrBJ,oBAAS,GAhDY,mBAgD5CK,EAhD4C,KAgDnCC,EAhDmC,KAmFnD,OAjCA3B,8BAAoBgB,GAAS,iBAAO,CAChCf,MAAM,WAAD,4BAAE,WAAOjB,GAAP,SAAAG,EAAA,6DACHsC,GAAQ,GADL,SAEG5C,EAAQoC,EAAOf,QAASiB,EAAU,EFjEtC,GEiEgD,GAF/C,2CAAF,mDAAC,GAINS,YAAa,WACTH,GAAQ,GACRE,GAAW,GACXJ,GAAW,GACXM,YAAW,WAEPZ,EAAOf,QAAQZ,UAAY,KAE3B,IAAIwC,GAAW,EAEfC,IAAMd,EAAOf,QAAR,uCAAiB,WAAgB8B,EAAGC,GAAnB,eAAA9C,EAAA,0DACd2C,EADc,oDAEdI,GAAQjB,EAAOf,QAAQX,aAAe0B,EAAOf,QAAQiC,cAAgB,IAC1Db,EAAUL,EAAOf,QAAQZ,UAAY4C,EAAOjB,EAAOf,QAAQZ,UAAY4C,GAHpE,wBAMdX,GAAYD,GACZQ,GAAW,EAPG,SAQRlC,IAAQC,MAAM,KARN,OASdoB,EAAOf,QAAQZ,UAAYgC,EAAU,KAAO,EAC5CQ,GAAW,EAVG,QAajBb,EAAe3B,WAAc2C,GAAMX,GAAW,EAAI,GAbjC,4CAAjB,yDAcF,KACJ,UAGJ,oCACFE,EACG,yBAAKpF,GAAG,YAAYuE,IAAKM,EAAQmB,UAAWd,EAAU,UAAY,IAC7DI,EACG,yBAAKjB,wBAAyB,CAACC,OAAQtC,KAEvC,6BACI,yBAAKgE,UAAU,OAAO3B,wBAAyB,CAACC,OAAQS,KACxD,yBAAKiB,UAAU,KAAK3B,wBAAyB,CAACC,OAAQU,OAIhE,OCzDCiB,EAnDO,WAClB,IAAMC,EAAwC7D,mBACxCuC,EAAuCvC,mBACzC8D,EAAaC,SAASC,eAAe,aACnCC,EAAc,uCAAG,sBAAAvD,EAAA,+EAETmD,EAASpC,QAAQD,MAAM,GAFd,uBAGTe,EAAQd,QAAQD,QAHP,uBAITqC,EAASpC,QAAQD,MAAM,GAJd,cAKfe,EAAQd,QAAQ0B,cALD,UAMThC,IAAQC,MAAM,KANL,yBAOTyC,EAASpC,QAAQD,MAAM,GAPd,6DASG,YAAd,KAAElB,QATS,iBAUX4D,IAVW,6FAAH,qDAgBdA,EAAiC,WACnCL,EAASpC,QAAQC,cAarB,OAJAyC,qBAAU,WACNF,IAAiBG,SAElB,IAEC,yBAAKzG,GAAG,OACJ,kBAAC,EAAD,CACIgD,kBAAkB,EAClBU,QAAQ,EACRS,eAZW,SAAC7B,GACpB6D,EAAWO,YAAcpE,GAYjBqB,YAhBQ,SAACrB,GACjB6D,EAAWO,aAAepE,GAgBlBJ,SAAUgE,IACd,kBAAC,EAAD,CACIxC,QAAQ,EACRkB,QAASA,MC7CzB+B,IAASC,OACL,kBAAC,EAAD,MACAR,SAASC,eAAe,W","file":"static/js/main.174f8e80.chunk.js","sourcesContent":["var map = {\n\t\"./styles0.css\": 22,\n\t\"./styles1.css\": 23,\n\t\"./styles2.css\": 24\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 21;","module.exports = \"/**\\n *\\n * 你好啊,小姐姐，我是Way，是一名程序员(俗称爱码士)。\\n *\\n * 我们日常的工作就是敲代码，我们喜欢捣鼓一些新奇的玩意儿。\\n * 啥？不知道啥是代码吗？那。。。\\n * 要不来一场直播写代码？\\n */\\n\\n/**\\n * 那么开始吧，首先让一切都动起来~\\n */\\n\\n* {\\n  -webkit-transition: all 1s;\\n}\\n\\n/**\\n * 这看似没用呀，别急，一会儿你就会看到效果了。\\n *\\n * 黑白配色太无聊了，哥哥我来做一些变化。\\n */\\n\\nhtml {\\n  background: rgb(63, 82, 99);\\n}\\n\\n/***\\n * 等等。\\n */\\n\\npre, a {\\n  color: white;\\n  box-sizing: border-box;\\n  \\n}\\n\\n/**\\n * 看上去好多了。但是有点刺眼了。\\n *\\n * 而且在整个屏幕上写代码有点浪费空间了。\\n *\\n * 不要着急哦，让我来做一些优化。\\n */\\n\\npre:not(:empty) {\\n  overflow: auto;\\n  background: rgb(48, 48, 48);\\n  border: 1px solid #ccc;\\n  max-height: 44.6%;\\n  width: 49%;\\n  font-size: 14px;\\n  font-family: monospace;\\n  padding: 10px 10px 20px;\\n  box-shadow: -4px 4px 2px 0 rgba(0,0,0,0.3);\\n  white-space: pre-wrap;\\n  outline: 0;\\n  position: absolute;\\n}\\n\\n/**\\n * 接下来我们在把它移到屏幕右侧。\\n */\\n\\n#style-text {\\n  -webkit-transform: translateX(95%);\\n  position: absolute;\\n}\\n\\n/**\\n * 看上去还不错喔, 但是所有的字体颜色是白色的！\\n *\\n * 那么，我们来把代码变的更加可读吧~\\n */\\n\\n.comment       { color: #857F6B; font-style: italic; }\\n.selector      { color: #E69F0F; }\\n.selector .key { color: #64D5EA; }\\n.key           { color: #64D5EA; }\\n.value         { color: #BE84F2; }\\n.value.px      { color: #F92772; }\\n\\n/**\\n * 现在我们有了一些进展。\\n *\\n * 再把它变得更立体&饱满一些。\\n */\\n\\nbody {\\n  -webkit-perspective: 1000px;\\n}\\n\\n#style-text {\\n  -webkit-transform: translateX(98.5%) rotateY(-10deg);\\n  -webkit-transform-origin: right;\\n  max-height: 94.5%;\\n}\\n\\n/**\\n * 好吧差不多了，接下来就聊聊我吧-(一个有多正经就有多深情的男人)。\\n *\\n * 我相信你应该不是来看我炫技的吧？\\n */\\n\\npre:not(#style-text) {\\n  -webkit-transform: rotateY(10deg);\\n  -webkit-transform-origin: left;\\n}\\n/**/\\n\\n\"","module.exports = \"/**\\n * 左侧的 markdown 看起来并不美观。\\n *\\n * 我们稍作修饰。\\n */\\n#work-text {\\n  max-height: 94.5%;\\n}\\n\\n#work-text.flipped {\\n  -webkit-transform: rotateX(0deg) rotateY(190deg) rotateZ(180deg);\\n}\\n\\n#work-text .md {\\n  -webkit-transform: rotateY(190deg) rotateZ(180deg);\\n  margin-top: 1200px;\\n}\\n\\n/**\\n * 下面就是见证奇迹的时刻：\\n *\\n * 3。\\n * 2。\\n * 1。\\n *\\n * 。\\n * 骗你啦，啥也没有~\\n *\\n * 好吧，其实是有的，来了。\\n *\\n */\\n\"","module.exports = \"\\n/**\\n * 文本可以做一些适当调整。\\n */\\n\\n.md {\\n  font-family: \\\"Helvetica Neue\\\", Helvetica, sans-serif;\\n}\\n\\n.md h1, .md h2, .md h3, .md h4, .md h5, .md h6 {\\n  display: inline-block;\\n  color: #ddd;\\n  border-bottom: 1px solid #ccc;\\n  padding-bottom: 5px;\\n}\\n\\n.md li {\\n  margin: 5px 0;\\n  line-height: 1.5;\\n}\\n\\n.md h1, .md h2, .md h3, .md h4, .md h5, .md h6, .md ul, .md p {\\n  margin: 0;\\n}\\n\\n\\n/**\\n * 还差最后一点就结束了。\\n */\\n\\npre:hover{\\n  box-shadow: 0 0 40px 5px rgba(255,255,255,0.4);\\n}\\n\\n/**\\n * 希望你能喜欢，这个创意是参考国外一个牛人的，\\n * 然后看到滴滴前架构师黄佚用Vue重构了一下，\\n * 我觉得很有趣，也用React+Hooks+TS重构了一下。\\n * 如果小姐姐觉得我还不错，可以与我联系~，ღ( ´･ᴗ･` )比心\\n */\\n\\n\\n\"","module.exports = \"\\r\\n基本资料\\r\\n=========\\r\\n\\r\\n* 姓名：卫正明(way) 。\\r\\n* Email： 1904628089@qq.com 。\\r\\n* GitHub：https://github.com/way-jm 。\\r\\n* PHONE: 18221924339 。\\r\\n* Wechat: 18221924330 。\\r\\n* BD： 1992.06.27 。\\r\\n\\r\\n个人爱好\\r\\n-------\\r\\n\\r\\n* 跑步，不务正业的中长跑爱好者。\\r\\n* 唱歌，给自己听，因为会跑掉。\\r\\n* 烧饭，我的理想是可以烧饭给小姐姐你吃。\\r\\n* 旅游，一个人旅游，这也是没办法的事\\r\\n* 游泳，我还有个名字叫卫正鱼\\r\\n\\r\\n\\r\\n教育背景\\r\\n-------\\r\\n* 2010.9-2014.6  本科：中南林业科技大学，日语\\r\\n* 2014.9 。。。。没有更高学历了，我一直认为我是南大未过门的学生。\\r\\n\\r\\n工作单位 安徽阡陌网络科技有限公司。\\r\\n\\r\\n还有\\r\\n---\\r\\n* 我想说的还有好多好多，不知道从何说起。\\r\\n* 村上说这个世界上的某个角落一定存在着能完全领会我的意思的人，你是不是也是在等这个世界上唯一契合你的灵魂呢？你看到句话的时候，有没有想过，\\r\\n  可能写下这句话的人就是呢\\r\\n* 有趣的灵魂真的好难得啊，因为不仅仅需要他的信息和知识层面都远高于你，还需要他愿意俯下身子听你讲那些没有营养的废话，并乐此不疲。我不能说我的灵魂有趣，我只是有点逗比。\\r\\n* 其实我的性子很慢，所以。。。但是其实我也可以很快，比如后面有只狗追我，或者，你愿意在前面等我。\\r\\n\\r\\n还有很多很多。。。\\r\\n\"","let openComment = false;\r\nconst commentRegex = /(\\/\\*(?:[^](?!\\/\\*))*\\*)$/;\r\nconst keyRegex = /([a-zA-Z- ^\\n]*)$/;\r\nconst valueRegex = /([^:]*)$/;\r\nconst selectorRegex = /(.*)$/;\r\nconst pxRegex = /\\dp/;\r\nconst pxRegex2 = /p$/;\r\nconst speed = 16;\r\n\r\nconst handleChar = (fullText: string, char: string) => {\r\n    if (openComment && char !== '/') {\r\n        fullText += char;\r\n    } else if (char === '/' && !openComment) {\r\n        openComment = true;\r\n        fullText += char;\r\n    } else if (char === '/' && fullText.slice(-1) === '*' && openComment) {\r\n        openComment = false;\r\n        fullText = fullText.replace(commentRegex, '<span class=\"comment\">$1/</span>');\r\n    } else if (char === ':') {\r\n        fullText = fullText.replace(keyRegex, '<span class=\"key\">$1</span>:');\r\n    } else if (char === '') {\r\n        fullText = fullText.replace(valueRegex, '<span class=\"value\">$1</span>');\r\n    } else if (char === '{') {\r\n        fullText = fullText.replace(selectorRegex, '<span class=\"selector\">$1</span>{');\r\n    } else if (char === 'x' && pxRegex.test(fullText.slice(-2))) {\r\n        fullText = fullText.replace(pxRegex2, '<span class=\"value px\">px</span>');\r\n    } else {\r\n        fullText += char;\r\n    }\r\n    return fullText;\r\n};\r\n\r\nexport {handleChar,speed};\r\n","import React, {useRef, useImperativeHandle,useReducer} from 'react';\r\nimport {handleChar} from \"../../utils/util\";\r\nimport Promise from 'bluebird';\r\nimport {speed} from \"../../utils/util\";\r\n\r\ninterface propsInterface {\r\n    animationSkipped: boolean,\r\n    paused: boolean,\r\n    styleOverwrite?: any,\r\n    styleAppend?: any\r\n    innerRef?: any\r\n}\r\n\r\nconst endOfSentence = /[？！。~：]$/;\r\nconst comma = /\\D[，；、]$/;\r\nconst endOfBlock = /[^/]\\n\\n$/;\r\n\r\nconst StyleText: React.FC<propsInterface> = (props) => {\r\n    function setT(state:any,char:string) {\r\n        return handleChar(state,char)\r\n    }\r\n    const [text, setText] = useReducer(setT, '');\r\n    const {innerRef} = props;\r\n    // 这里需要使用强制同步数据流传递给父组件，useState，useReducer都不满足要求\r\n    let styleBuffer='';\r\n\r\n    const elRef = useRef(null);\r\n    const styleText = [0, 1, 2].map(i => {\r\n\r\n\r\n        return require('!!raw-loader!./styles' + i + '.css');\r\n    });\r\n    const writeTo: any = async (el: Element, message: string, index: number, interval: number, charsPerInterval: number) => {\r\n        if (props.animationSkipped) {\r\n            throw new Error('SKIP IT');\r\n        }\r\n        let chars = message.slice(index, index + charsPerInterval);\r\n        index += charsPerInterval;\r\n\r\n        el.scrollTop = el.scrollHeight;\r\n\r\n        writeChar(chars);\r\n\r\n        if (index < message.length) {\r\n            let thisInterval = interval;\r\n            let thisSlice = message.slice(index - 2, index);\r\n            if (comma.test(thisSlice)) {\r\n                thisInterval = interval * 30;\r\n            }\r\n            if (endOfSentence.test(thisSlice)) {\r\n                thisInterval = interval * 70;\r\n            }\r\n            thisSlice = message.slice(index - 2, index + 1);\r\n            if (endOfBlock.test(thisSlice)) {\r\n                thisInterval = interval * 50;\r\n            }\r\n\r\n            do {\r\n                await Promise.delay(thisInterval);\r\n            } while (props.paused);\r\n            return writeTo(el, message, index, interval, charsPerInterval);\r\n        }\r\n    };\r\n    const writeChar = (char: string) => {\r\n        setText(char);\r\n        styleBuffer=styleBuffer + char;\r\n        if (char === ';'||char==='}') {\r\n            props.styleAppend(styleBuffer);\r\n            styleBuffer='';\r\n        }\r\n    };\r\n    useImperativeHandle(innerRef, () => ({\r\n        write: async (index: number) => {\r\n            await writeTo(elRef.current, styleText[index], 0, speed, 1);\r\n        },\r\n        writeToEnd: () => {\r\n            let txt = styleText.join('\\n');\r\n            let styleHTML = '';\r\n            for (let i = 0; i < txt.length; i++) {\r\n                styleHTML = handleChar(styleHTML, txt[i]);\r\n            }\r\n            setText(styleHTML);\r\n            props.styleOverwrite('#work-text * {transition: none; }' + txt);\r\n        }\r\n    }));\r\n    return <pre id='style-text' contentEditable dangerouslySetInnerHTML={{__html: text}} ref={elRef}/>;\r\n};\r\n\r\nexport default StyleText;\r\n","import React, {useImperativeHandle, useReducer, useState, useRef} from 'react';\r\nimport Promise from 'bluebird';\r\nimport {handleChar} from \"../../utils/util\";\r\nimport wheel from 'mouse-wheel';\r\nimport Markdown from 'markdown';\r\n\r\nimport {speed} from \"../../utils/util\";\r\n\r\n\r\nconst toHTML = Markdown.markdown.toHTML;\r\n\r\ninterface propsInterface {\r\n    paused: boolean,\r\n    workRef?: any\r\n}\r\n\r\nconst endOfSentence = /[？！。~：]$/;\r\nconst comma = /\\D[，；、]$/;\r\nconst endOfBlock = /[^/]\\n\\n$/;\r\nconst WorkStyle: React.FC<propsInterface> = (props) => {\r\n    const {workRef} = props;\r\n\r\n\r\n    function setT(state: any, char: string) {\r\n        return handleChar(state, char);\r\n    }\r\n\r\n    const el2Ref: React.MutableRefObject<any> = useRef<HTMLElement>(null);\r\n\r\n    const writeTo: any = async (el: Element, message: string, index: number, interval: number, charsPerInterval: number) => {\r\n        let chars = message.slice(index, index + charsPerInterval);\r\n        index += charsPerInterval;\r\n\r\n        el.scrollTop = el.scrollHeight;\r\n        writeSimpleChar(chars);\r\n\r\n        if (index < message.length) {\r\n            let thisInterval = interval;\r\n            let thisSlice = message.slice(index - 2, index);\r\n            if (comma.test(thisSlice)) {\r\n                thisInterval = interval * 30;\r\n            }\r\n            if (endOfSentence.test(thisSlice)) {\r\n                thisInterval = interval * 70;\r\n            }\r\n            thisSlice = message.slice(index - 2, index + 1);\r\n            if (endOfBlock.test(thisSlice)) {\r\n                thisInterval = interval * 50;\r\n            }\r\n\r\n            do {\r\n                await Promise.delay(thisInterval);\r\n            } while (props.paused);\r\n            return writeTo(el, message, index, interval, charsPerInterval);\r\n        }\r\n    };\r\n    const writeSimpleChar = (char: string) => {\r\n        setText(char);\r\n    };\r\n\r\n    const [text, setText] = useReducer(setT, '');\r\n    // eslint-disable-next-line import/no-webpack-loader-syntax\r\n    const workText = require('!!raw-loader!./work.txt');\r\n    const mdText = toHTML(workText);\r\n\r\n    const [flipped, setFlipped] = useState(false);\r\n    const [show, setShow] = useState(false);\r\n    const [preview, setPreview] = useState(true);\r\n\r\n    useImperativeHandle(workRef, () => ({\r\n        write: async (index: number) => {\r\n            setShow(true);\r\n            await writeTo(el2Ref.current, workText, 0, speed, 1);\r\n        },\r\n        showWorkBox: () => {\r\n            setShow(true);\r\n            setPreview(false);\r\n            setFlipped(true);\r\n            setTimeout(() => {\r\n\r\n                el2Ref.current.scrollTop = 9999;\r\n\r\n                let flipping = false;\r\n                // @ts-ignore\r\n                wheel(el2Ref.current, async function (dx,dy) {\r\n                    if (flipping) return;\r\n                    let half = (el2Ref.current.scrollHeight - el2Ref.current.clientHeight) / 2;\r\n                    let pastHalf = flipped ? el2Ref.current.scrollTop < half : el2Ref.current.scrollTop > half;\r\n\r\n                    if (pastHalf) {\r\n                        setFlipped(!flipped);\r\n                        flipping = true;\r\n                        await Promise.delay(500);\r\n                        el2Ref.current.scrollTop = flipped ? 9999 : 0;\r\n                        flipping = false;\r\n                    }\r\n\r\n                    (el2Ref as any).scrollTop += (dy * (flipped ? -1 : 1));\r\n                }, true);\r\n            }, 200);\r\n        }\r\n    }));\r\n    return <>\r\n        {show ?\r\n            <pre id='work-text' ref={el2Ref} className={flipped ? 'flipped' : ''}>\r\n                {preview ?\r\n                    <div dangerouslySetInnerHTML={{__html: text}} />\r\n                    :\r\n                    <div>\r\n                        <div className=\"text\" dangerouslySetInnerHTML={{__html: workText}}/>\r\n                        <div className=\"md\" dangerouslySetInnerHTML={{__html: mdText}}/>\r\n                    </div>\r\n                }\r\n            </pre>\r\n            : null}\r\n    </>;\r\n\r\n};\r\n\r\nexport default WorkStyle;\r\n","import React, {useRef, useEffect} from 'react';\nimport Promise from 'bluebird';\nimport './App.css';\nimport StyleText from \"./components/style-text/style-text\";\nimport WorkStyle from \"./components/work-text/work-style\";\n\nconst App: React.FC = () => {\n    const styleRef: React.MutableRefObject<any> = useRef();\n    const workRef: React.MutableRefObject<any> = useRef();\n    let styleTagEl = document.getElementById('style-tag') as HTMLElement;\n    const startAnimation = async () => {\n        try {\n            await styleRef.current.write(0);\n            await workRef.current.write();\n            await styleRef.current.write(1);\n            workRef.current.showWorkBox();\n            await Promise.delay(2000);\n            await styleRef.current.write(2);\n        } catch (e) {\n            if (e.message === 'SKIP IT') {\n                surprisinglyShortAttentionSpan();\n            } else {\n                throw e;\n            }\n        }\n    };\n    const surprisinglyShortAttentionSpan = () => {\n        styleRef.current.writeToEnd();\n        // this.$refs.workText.showWorkBox()\n    };\n    const styleAppend = (styleText: any) => {\n        styleTagEl.textContent += styleText;\n    };\n    const styleOverwrite = (styleText: any) => {\n        styleTagEl.textContent = styleText;\n    };\n    useEffect(() => {\n        startAnimation().then();\n        // eslint-disable-next-line\n    }, []);\n    return (\n        <div id=\"App\">\n            <StyleText\n                animationSkipped={false}\n                paused={false}\n                styleOverwrite={styleOverwrite}\n                styleAppend={styleAppend}\n                innerRef={styleRef}/>\n            <WorkStyle\n                paused={false}\n                workRef={workRef}\n            />\n\n        </div>\n    );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n    <App/>,\n    document.getElementById('root')\n);\n\n\n"],"sourceRoot":""}